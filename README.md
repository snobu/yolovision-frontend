Some slight code contribution by https://github.com/radu-matei. Please don't sue.
